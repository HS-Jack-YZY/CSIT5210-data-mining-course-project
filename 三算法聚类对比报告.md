# 三算法聚类对比总结
## K-Means vs GMM vs DBSCAN - AG News 文本聚类综合分析

**作者：** Jack YUAN  
**课程：** CSIT5210 - 数据挖掘  
**日期：** 2025年11月10日  
**学校：** 香港科技大学  

---

## 执行摘要

本报告综合对比了三种经典聚类算法在 AG News 文本分类数据集上的表现：
1. **K-Means**（质心聚类）
2. **GMM**（概率聚类）
3. **DBSCAN**（密度聚类）

**核心结论：**
- **K-Means 和 GMM 性能几乎相同**（差异 <1%），均表现不佳
- **DBSCAN 完全失败**，无法产生有意义的聚类
- **根本原因**：高维 BERT 嵌入空间不支持语义类别聚类
- **推荐算法**：K-Means（最简单、最快）

---

## 1. 算法对比矩阵

### 1.1 性能指标对比

| 指标 | K-Means | GMM | DBSCAN | 最佳 | 差距 |
|------|---------|-----|--------|------|------|
| **簇数量** | 4 | 4 | **1** | K-Means/GMM | DBSCAN -75% |
| **Silhouette** | **0.000804** | 0.000743 | N/A | K-Means | GMM -7.6% |
| **Davies-Bouldin** | **26.21** | 26.29 | N/A | K-Means | GMM +0.3% |
| **Purity** | 0.2528 | **0.2534** | 0.2500 | GMM | GMM +0.24% |
| **运行时间** | ~120s | 815s | 238s | K-Means | GMM 慢 6.8× |

**关键发现：**
1. K-Means 和 GMM 质量指标差异 <1%（统计上相同）
2. DBSCAN 仅产生单一聚类（等同于未聚类）
3. 所有算法 Purity ≈ 25%（随机基线）

### 1.2 算法特性对比

| 特性 | K-Means | GMM | DBSCAN |
|------|---------|-----|--------|
| **聚类类型** | 硬聚类 | 软聚类（概率） | 密度聚类 |
| **簇形状** | 球形 | 椭圆形（可调） | 任意形状 |
| **K 预设** | 需要 | 需要 | 自动 |
| **噪声处理** | 无 | 无 | 有 |
| **不确定性量化** | 无 | **有** | 无 |
| **复杂度** | O(nkd) | O(nkd·iter) | O(n²) |
| **收敛保证** | 无（局部最优） | 无（局部最优） | N/A |

---

## 2. 详细对比分析

### 2.1 K-Means：简单基线

**优势：**
- ✅ 实现简单，易于理解
- ✅ 运行快速（~2 分钟）
- ✅ 内存消耗低
- ✅ Silhouette 最高（0.000804）

**劣势：**
- ❌ 球形簇假设
- ❌ 欧氏距离次优（文本更适合余弦）
- ❌ 对初始化敏感
- ❌ 无不确定性量化

**本任务表现：**
- 产生 4 个均衡聚类
- Purity 25.28%（接近随机）
- **结论：勉强可用的基线**

### 2.2 GMM：概率建模

**优势：**
- ✅ 提供概率分配
- ✅ **不确定性量化**（61% 低置信度）
- ✅ 灵活簇形状（协方差类型）
- ✅ Purity 最高（0.2534）

**劣势：**
- ❌ EM 算法慢（815 秒，6.8× K-Means）
- ❌ 参数多（需选择协方差类型）
- ❌ 对初始化敏感
- ❌ 高维协方差估计困难

**本任务表现：**
- 产生 4 个均衡聚类
- 揭示 61% 文档置信度 <0.5
- **结论：与 K-Means 相同，但提供额外洞察**

### 2.3 DBSCAN：密度聚类

**优势（理论）：**
- ✅ 自动确定簇数
- ✅ 发现任意形状聚类
- ✅ 识别噪声点
- ✅ 对离群值鲁棒

**劣势（实际）：**
- ❌ **在高维空间完全失败**
- ❌ 参数调优极困难（eps 敏感）
- ❌ 余弦距离表现差
- ❌ O(n²) 复杂度

**本任务表现：**
- 产生 **1 个聚类**（或全噪声）
- 12 种参数组合均失败
- **结论：完全不适用**

---

## 3. 失败模式分析

### 3.1 为何三个算法都失败？

**根本原因：高维嵌入空间特性**

1. **维度诅咒：**
   - 768 维空间中距离失去意义
   - 最近邻与最远邻距离接近

2. **嵌入优化目标不匹配：**
   - Gemini 嵌入优化于**语义相似度**（检索）
   - 非优化于**类别可分性**（分类）

3. **类别语义重叠：**
   - "奥运赞助"（体育+商业）
   - "政府科技资助"（国际+科技）

### 3.2 K-Means vs GMM 为何相同？

**数学解释：**

在高维空间中：
1. **高斯分布退化**：协方差矩阵难以准确估计
2. **EM ≈ K-Means**：GMM 收敛到与 K-Means 类似的解
3. **簇形状不重要**：数据无明显椭圆/球形结构

**实验证据：**
- GMM Spherical（球形）BIC 最低 → 与 K-Means 假设一致
- 性能差异 <1% → 优化到相同局部最优

### 3.3 DBSCAN 为何彻底失败？

**密度概念在高维失效：**

1. **距离集中现象**：
   ```
   eps < 0.7: 所有点都"远" → 100% 噪声
   eps ≥ 1.0: 所有点都"近" → 单簇
   ```

2. **无密度梯度**：
   - 数据在 768 维超球面上均匀分布
   - 无明显密集/稀疏区域

3. **参数空间退化**：
   - 无中间 eps 值产生 2-10 簇
   - 阶跃函数（0 簇 ↔ 1 簇）

---

## 4. 实用建议

### 4.1 算法选择决策树

```
START
 ├─ 需要不确定性量化？
 │   ├─ 是 → GMM
 │   └─ 否 → 下一步
 ├─ 数据维度 >100？
 │   ├─ 是 → K-Means（避免 DBSCAN）
 │   └─ 否 → 考虑 DBSCAN
 ├─ 簇数已知？
 │   ├─ 是 → K-Means/GMM
 │   └─ 否 → DBSCAN（低维）或层次聚类
 └─ 追求速度？
     ├─ 是 → K-Means
     └─ 否 → GMM
```

**AG News 任务推荐：**
1. **首选**：K-Means（简单、快速、效果相同）
2. **次选**：GMM（需要不确定性分析时）
3. **避免**：DBSCAN（高维不适用）

### 4.2 改进方向

**方向1：嵌入优化**
- 监督微调 BERT（用 AG News 标签）
- 使用分类任务训练的嵌入
- 对比学习（SimCLR, MoCo）

**方向2：降维 + 聚类**
- PCA/UMAP 降至 50 维
- 然后应用 K-Means/GMM
- 可能改善聚类质量

**方向3：深度聚类**
- DEC (Deep Embedded Clustering)
- IDEC (Improved DEC)
- 联合学习嵌入和聚类

---

## 5. 量化结果汇总

### 5.1 性能得分卡

| 算法 | 质量得分 | 速度得分 | 易用性 | 可解释性 | 总分 |
|------|----------|----------|--------|----------|------|
| K-Means | 2/10 | 10/10 | 10/10 | 8/10 | **7.5/10** |
| GMM | 2/10 | 4/10 | 6/10 | **10/10** | 5.5/10 |
| DBSCAN | **0/10** | 6/10 | 2/10 | 0/10 | 2/10 |

**评分标准：**
- 质量：Purity 离目标（70%）的距离
- 速度：运行时间
- 易用性：参数调优难度
- 可解释性：输出理解难度

### 5.2 成本收益分析

| 算法 | 开发时间 | 运行时间 | 计算资源 | 结果价值 | ROI |
|------|----------|----------|----------|----------|-----|
| K-Means | 低 | 低 | 低 | 低（基线） | **高** |
| GMM | 中 | 高 | 中 | 中（洞察） | 中 |
| DBSCAN | 高 | 中 | 高 | **极低** | **极低** |

**ROI (Return on Investment):**
- K-Means：虽然效果差，但投入最小，适合快速验证
- GMM：提供不确定性分析，值得探索性研究
- DBSCAN：高投入零回报，不推荐

---

## 6. 关键洞察

### 洞察1：算法选择不是主要问题

**证据：**
- K-Means、GMM 性能差异 <1%
- 两者 Purity 都 ≈ 25%（随机）

**结论：**
改变聚类算法无法解决问题，需从根源（嵌入）入手。

### 洞察2：GMM 的价值在于揭示问题

**61% 低置信度的意义：**
- 不是 GMM 失败，是**任务不可行**
- K-Means 强制分配，掩盖了不确定性
- GMM 诚实揭示："我不知道"

**科学价值：**
诚实的负面结果比虚假的正面结果更有价值。

### 洞察3：DBSCAN 不适合高维文本

**理论原因：**
- 密度概念在高维失效
- 参数空间退化

**实践建议：**
文本嵌入聚类**永远不要首选 DBSCAN**，除非先降维。

---

## 7. 最终建议

### 对于 AG News 聚类任务：

**短期方案（当前数据）：**
1. 使用 **K-Means** 作为基线（Purity 25.28%）
2. 接受聚类质量差的现实
3. 考虑改用监督学习（分类）

**中期方案（优化嵌入）：**
1. 微调 BERT（用 AG News 标签）
2. 提取嵌入 + K-Means/GMM
3. 预期 Purity 提升至 60-80%

**长期方案（深度方法）：**
1. 端到端深度聚类（DEC/IDEC）
2. 联合优化嵌入和聚类目标
3. 预期 Purity 接近监督学习（>85%）

### 对于其他高维聚类任务：

**通用流程：**
```
1. 降维（PCA/UMAP）至 10-50 维
2. K-Means 快速验证
3. GMM 深入分析（如需不确定性）
4. 避免 DBSCAN（除非维度 <10）
```

---

## 8. 结论

1. **K-Means 和 GMM 性能相同**（差异 <1%）
2. **DBSCAN 在高维文本上失败**（单簇退化）
3. **Purity 25% ≈ 随机**（所有算法均失败）
4. **根本问题**：嵌入不适合聚类（优化目标不匹配）
5. **推荐**：K-Means（简单、快速、效果相同）
6. **洞察**：GMM 的 61% 低置信度揭示了任务不可行性

**核心教训：**
理解算法假设与数据特性的匹配度，比盲目尝试多种算法更重要。

---

## 附录：完整对比表

### A.1 三算法详细指标

| 指标 | K-Means | GMM | DBSCAN | 说明 |
|------|---------|-----|--------|------|
| Silhouette Score | 0.000804 | 0.000743 | N/A | [-1,1]，越高越好 |
| Davies-Bouldin | 26.21 | 26.29 | N/A | [0,∞)，越低越好 |
| Purity (Overall) | 0.2528 | 0.2534 | 0.2500 | [0,1]，越高越好 |
| 簇 0 纯度 | 0.253 | 0.254 | 0.250 | 主导类占比 |
| 簇 1 纯度 | 0.254 | 0.254 | 0.250 | 主导类占比 |
| 簇 2 纯度 | 0.253 | 0.253 | 0.250 | 主导类占比 |
| 簇 3 纯度 | 0.251 | 0.252 | 0.250 | 主导类占比 |
| 簇数量 | 4 | 4 | 1 | 期望 4 |
| 噪声点 | 0 | 0 | 0 | DBSCAN 特有 |
| 平均簇大小 | 30,000 | 30,000 | 120,000 | 均衡性 |
| 簇大小标准差 | 106 | 364 | 0 | 越小越均衡 |
| 运行时间(s) | ~120 | 815 | 238 | 不含调优 |
| 内存峰值(GB) | ~2 | ~3 | ~2 | 估算值 |

### A.2 协方差/参数对比（GMM）

| 协方差类型 | BIC | AIC | Silhouette | 参数数 |
|-----------|-----|-----|------------|--------|
| Spherical | 261,588,873 | 261,559,024 | 0.000743 | 3,079 |
| Diag | 261,621,234 | 261,561,632 | 0.000549 | 6,147 |
| Tied | 264,746,194 | 261,853,408 | 0.000799 | 298,323 |
| Full | 274,162,457 | 262,680,768 | 0.000709 | 2,359,296 |

### A.3 DBSCAN 参数扫描（12 组合）

| eps | min_samples | 簇数 | 噪声比例 | 结果 |
|-----|-------------|------|----------|------|
| 0.3-0.7 | 3/5/10 | 0 | 100% | 全噪声 |
| 1.0 | 3/5/10 | 1 | 0% | 单簇 |

---

**文档版本：** 1.0  
**最后更新：** 2025年11月10日  
**总页数：** 10  
**相关报告：**
- K-Means 聚类实验报告.md
- GMM 聚类实验报告.md
- DBSCAN 聚类实验报告.md
